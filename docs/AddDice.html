<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: AddDice
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "AddDice";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (A)</a> &raquo;
    
    
    <span class="title">AddDice</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: AddDice
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">AddDice</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>dice/AddDice.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addDiceArrayByAddDiceCount-instance_method" title="#addDiceArrayByAddDiceCount (instance method)">#<strong>addDiceArrayByAddDiceCount</strong>(dice_dat, _dice_max, dice_queue, roll_times)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getOperatorText-instance_method" title="#getOperatorText (instance method)">#<strong>getOperatorText</strong>(rate, output)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#getSlashedDice-instance_method" title="#getSlashedDice (instance method)">#<strong>getSlashedDice</strong>(slashMark, lhs)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(bcdice, diceBot)  &#x21d2; AddDice </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of AddDice.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollD66-instance_method" title="#rollD66 (instance method)">#<strong>rollD66</strong>(count)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollDice-instance_method" title="#rollDice (instance method)">#<strong>rollDice</strong>(string)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>加算ダイス        ########################.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollDiceAddingUp-instance_method" title="#rollDiceAddingUp (instance method)">#<strong>rollDiceAddingUp</strong>(string, isCheckSuccess = false)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>加算ダイスロール(個別処理).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollDiceAddingUpCommand-instance_method" title="#rollDiceAddingUpCommand (instance method)">#<strong>rollDiceAddingUpCommand</strong>(dice_count, dice_max, slashMark, double_check, isCheckSuccess, critical)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rollLocal-instance_method" title="#rollLocal (instance method)">#<strong>rollLocal</strong>(dice_wk, dice_max, sortType)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(bcdice, diceBot)  &#x21d2; <tt><span class='object_link'><a href="" title="AddDice (class)">AddDice</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of AddDice</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6
7
8</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_bcdice'>bcdice</span><span class='comma'>,</span> <span class='id identifier rubyid_diceBot'>diceBot</span><span class='rparen'>)</span>
  <span class='ivar'>@bcdice</span> <span class='op'>=</span> <span class='id identifier rubyid_bcdice'>bcdice</span>
  <span class='ivar'>@diceBot</span> <span class='op'>=</span> <span class='id identifier rubyid_diceBot'>diceBot</span>
  <span class='ivar'>@nick_e</span> <span class='op'>=</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_nick_e'>nick_e</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="addDiceArrayByAddDiceCount-instance_method">
  
    #<strong>addDiceArrayByAddDiceCount</strong>(dice_dat, _dice_max, dice_queue, roll_times)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 256</span>

<span class='kw'>def</span> <span class='id identifier rubyid_addDiceArrayByAddDiceCount'>addDiceArrayByAddDiceCount</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='comma'>,</span> <span class='id identifier rubyid__dice_max'>_dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_queue'>dice_queue</span><span class='comma'>,</span> <span class='id identifier rubyid_roll_times'>roll_times</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_i</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_count_bucket'>count_bucket</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_val'>val</span><span class='op'>|</span>
    <span class='id identifier rubyid_count_bucket'>count_bucket</span><span class='lbracket'>[</span><span class='id identifier rubyid_val'>val</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_count_bucket'>count_bucket</span><span class='lbracket'>[</span><span class='id identifier rubyid_val'>val</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_reroll_threshold'>reroll_threshold</span> <span class='op'>=</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sameDiceRerollCount'>sameDiceRerollCount</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='id identifier rubyid_roll_times'>roll_times</span> <span class='op'>:</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sameDiceRerollCount'>sameDiceRerollCount</span>
  <span class='id identifier rubyid_count_bucket'>count_bucket</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_num'>num</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_num'>num</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_reroll_threshold'>reroll_threshold</span>
      <span class='id identifier rubyid_dice_queue'>dice_queue</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_num'>num</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getOperatorText-instance_method">
  
    #<strong>getOperatorText</strong>(rate, output)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


316
317
318
319
320
321
322
323
324</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 316</span>

<span class='kw'>def</span> <span class='id identifier rubyid_getOperatorText'>getOperatorText</span><span class='lparen'>(</span><span class='id identifier rubyid_rate'>rate</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_rate'>rate</span> <span class='op'>&lt;</span> <span class='int'>0</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>-</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="getSlashedDice-instance_method">
  
    #<strong>getSlashedDice</strong>(slashMark, lhs)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 273</span>

<span class='kw'>def</span> <span class='id identifier rubyid_getSlashedDice'>getSlashedDice</span><span class='lparen'>(</span><span class='id identifier rubyid_slashMark'>slashMark</span><span class='comma'>,</span> <span class='id identifier rubyid_lhs'>lhs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>^/(\d+)(.)?$</span><span class='regexp_end'>}i</span></span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_slashMark'>slashMark</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_lhs'>lhs</span> <span class='kw'>unless</span> <span class='id identifier rubyid_m'>m</span>

  <span class='id identifier rubyid_rhs'>rhs</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='id identifier rubyid_mark'>mark</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_lhs'>lhs</span> <span class='kw'>if</span> <span class='id identifier rubyid_rhs'>rhs</span> <span class='op'>==</span> <span class='int'>0</span>

  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_lhs'>lhs</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='id identifier rubyid_rhs'>rhs</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_mark'>mark</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>U</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_ceil'>ceil</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_mark'>mark</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>R</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_floor'>floor</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rollD66-instance_method">
  
    #<strong>rollD66</strong>(count)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


301
302
303
304
305
306
307
308
309
310
311
312
313
314</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 301</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rollD66'>rollD66</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_d66List'>d66List</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_d66List'>d66List</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_getD66Value'>getD66Value</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_total'>total</span> <span class='op'>=</span> <span class='id identifier rubyid_d66List'>d66List</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_sum'>sum</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_sum'>sum</span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_d66List'>d66List</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_n1Count'>n1Count</span> <span class='op'>=</span> <span class='id identifier rubyid_d66List'>d66List</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_nMaxCount'>nMaxCount</span> <span class='op'>=</span> <span class='id identifier rubyid_d66List'>d66List</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='int'>66</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_total'>total</span><span class='comma'>,</span> <span class='id identifier rubyid_text'>text</span><span class='comma'>,</span> <span class='id identifier rubyid_n1Count'>n1Count</span><span class='comma'>,</span> <span class='id identifier rubyid_nMaxCount'>nMaxCount</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rollDice-instance_method">
  
    #<strong>rollDice</strong>(string)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>加算ダイス        ########################</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 12</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rollDice'>rollDice</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AddDice.rollDice() begin string</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>(^|\s)S?(([\d\+\*\-]*[\d]+D[\d/UR@]*[\d\+\*\-D/UR]*)(([&lt;&gt;=]+)([?\-\d]+))?)($|\s)</span><span class='regexp_end'>}i</span></span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_m'>m</span>

  <span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_judgeText'>judgeText</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='comment'># &#39;&gt;=10&#39;といった成否判定文字
</span>  <span class='id identifier rubyid_judgeOperator'>judgeOperator</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span> <span class='comment'># &#39;&gt;=&#39; といった判定の条件演算子 文字
</span>  <span class='id identifier rubyid_diffText'>diffText</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>6</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_signOfInequality'>signOfInequality</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_judgeText'>judgeText</span>
    <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_signOfInequality'>signOfInequality</span> <span class='op'>=</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_marshalSignOfInequality'>marshalSignOfInequality</span><span class='lparen'>(</span><span class='id identifier rubyid_judgeOperator'>judgeOperator</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_dice_cnt'>dice_cnt</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_dice_max'>dice_max</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_total_n'>total_n</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_dice_n'>dice_n</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_n1'>n1</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_n_max'>n_max</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_addUpTextList'>addUpTextList</span> <span class='op'>=</span> <span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_addUpTextList'>addUpTextList</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_addUpText'>addUpText</span><span class='op'>|</span>
    <span class='id identifier rubyid_subtractTextList'>subtractTextList</span> <span class='op'>=</span> <span class='id identifier rubyid_addUpText'>addUpText</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_subtractTextList'>subtractTextList</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subtractText'>subtractText</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_subtractText'>subtractText</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>begin rollDiceAddingUp(subtractText, isCheckSuccess)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_subtractText'>subtractText</span><span class='comma'>,</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dice_now'>dice_now</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_n_wk'>dice_n_wk</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_str'>dice_str</span><span class='comma'>,</span> <span class='id identifier rubyid_n1_wk'>n1_wk</span><span class='comma'>,</span> <span class='id identifier rubyid_n_max_wk'>n_max_wk</span><span class='comma'>,</span> <span class='id identifier rubyid_cnt_wk'>cnt_wk</span><span class='comma'>,</span> <span class='id identifier rubyid_max_wk'>max_wk</span> <span class='op'>=</span> <span class='id identifier rubyid_rollDiceAddingUp'>rollDiceAddingUp</span><span class='lparen'>(</span><span class='id identifier rubyid_subtractText'>subtractText</span><span class='comma'>,</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>end rollDiceAddingUp(subtractText, isCheckSuccess) -&gt; dice_now</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_now'>dice_now</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_rate'>rate</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_index'>index</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>?</span> <span class='int'>1</span> <span class='op'>:</span> <span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_total_n'>total_n</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_now'>dice_now</span> <span class='op'>*</span> <span class='id identifier rubyid_rate'>rate</span>
      <span class='id identifier rubyid_dice_n'>dice_n</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_n_wk'>dice_n_wk</span> <span class='op'>*</span> <span class='id identifier rubyid_rate'>rate</span>
      <span class='id identifier rubyid_n1'>n1</span> <span class='op'>+=</span> <span class='id identifier rubyid_n1_wk'>n1_wk</span>
      <span class='id identifier rubyid_n_max'>n_max</span> <span class='op'>+=</span> <span class='id identifier rubyid_n_max_wk'>n_max_wk</span>
      <span class='id identifier rubyid_dice_cnt'>dice_cnt</span> <span class='op'>+=</span> <span class='id identifier rubyid_cnt_wk'>cnt_wk</span>
      <span class='id identifier rubyid_dice_max'>dice_max</span> <span class='op'>=</span> <span class='id identifier rubyid_max_wk'>max_wk</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_wk'>max_wk</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_dice_max'>dice_max</span>

      <span class='kw'>next</span> <span class='kw'>if</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sendMode'>sendMode</span> <span class='op'>==</span> <span class='int'>0</span>

      <span class='id identifier rubyid_operatorText'>operatorText</span> <span class='op'>=</span> <span class='id identifier rubyid_getOperatorText'>getOperatorText</span><span class='lparen'>(</span><span class='id identifier rubyid_rate'>rate</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_operatorText'>operatorText</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dice_str'>dice_str</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_signOfInequality'>signOfInequality</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_string'>string</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_signOfInequality'>signOfInequality</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diffText'>diffText</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_setDiceText'>setDiceText</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='rparen'>)</span>
  <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_setDiffText'>setDiffText</span><span class='lparen'>(</span><span class='id identifier rubyid_diffText'>diffText</span><span class='rparen'>)</span>

  <span class='comment'># ダイス目による補正処理（現状ナイトメアハンターディープ専用）
</span>  <span class='id identifier rubyid_addText'>addText</span><span class='comma'>,</span> <span class='id identifier rubyid_revision'>revision</span> <span class='op'>=</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_getDiceRevision'>getDiceRevision</span><span class='lparen'>(</span><span class='id identifier rubyid_n_max'>n_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_total_n'>total_n</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>addText, revision</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_addText'>addText</span><span class='comma'>,</span> <span class='id identifier rubyid_revision'>revision</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@nick_e</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@nick_e</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sendMode'>sendMode</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_output'>output</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>[^\d\[\]]+</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@nick_e</span><span class='embexpr_end'>}</span><span class='tstring_content'>: (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_string'>string</span><span class='embexpr_end'>}</span><span class='tstring_content'>) ＞ </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='embexpr_end'>}</span><span class='tstring_content'> ＞ </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_total_n'>total_n</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_addText'>addText</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@nick_e</span><span class='embexpr_end'>}</span><span class='tstring_content'>: (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_string'>string</span><span class='embexpr_end'>}</span><span class='tstring_content'>) ＞ </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_total_n'>total_n</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_addText'>addText</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@nick_e</span><span class='embexpr_end'>}</span><span class='tstring_content'>: (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_string'>string</span><span class='embexpr_end'>}</span><span class='tstring_content'>) ＞ </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_total_n'>total_n</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_addText'>addText</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_total_n'>total_n</span> <span class='op'>+=</span> <span class='id identifier rubyid_revision'>revision</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_signOfInequality'>signOfInequality</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='comment'># 成功度判定処理
</span>    <span class='id identifier rubyid_successText'>successText</span> <span class='op'>=</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_check_suc'>check_suc</span><span class='lparen'>(</span><span class='id identifier rubyid_total_n'>total_n</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_n'>dice_n</span><span class='comma'>,</span> <span class='id identifier rubyid_signOfInequality'>signOfInequality</span><span class='comma'>,</span> <span class='id identifier rubyid_diffText'>diffText</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_cnt'>dice_cnt</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_n1'>n1</span><span class='comma'>,</span> <span class='id identifier rubyid_n_max'>n_max</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>check_suc successText</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_successText'>successText</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='id identifier rubyid_successText'>successText</span>
  <span class='kw'>end</span>

  <span class='comment'># ダイスロールによるポイント等の取得処理用（T&amp;T悪意、ナイトメアハンター・ディープ宿命、特命転校生エクストラパワーポイントなど）
</span>  <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_getDiceRolledAdditionalText'>getDiceRolledAdditionalText</span><span class='lparen'>(</span><span class='id identifier rubyid_n1'>n1</span><span class='comma'>,</span> <span class='id identifier rubyid_n_max'>n_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_dice_cnt'>dice_cnt</span> <span class='op'>==</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id identifier rubyid_dice_max'>dice_max</span> <span class='op'>==</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AddDice.rollDice() end output</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rollDiceAddingUp-instance_method">
  
    #<strong>rollDiceAddingUp</strong>(string, isCheckSuccess = false)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>加算ダイスロール(個別処理)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 109</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rollDiceAddingUp'>rollDiceAddingUp</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='comma'>,</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span> <span class='comment'># 加算ダイスロール(個別処理)
</span>  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rollDiceAddingUp() begin string</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_dice_max'>dice_max</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_dice_total'>dice_total</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_dice_n'>dice_n</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_n1'>n1</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_n_max'>n_max</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_dice_cnt_total'>dice_cnt_total</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_double_check'>double_check</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='kw'>if</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sameDiceRerollCount'>sameDiceRerollCount</span> <span class='op'>!=</span> <span class='int'>0</span> <span class='comment'># 振り足しありのゲームでダイスが二個以上
</span>    <span class='kw'>if</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sameDiceRerollType'>sameDiceRerollType</span> <span class='op'>&lt;=</span> <span class='int'>0</span> <span class='comment'># 判定のみ振り足し
</span>      <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>判定のみ振り足し</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_double_check'>double_check</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span>
    <span class='kw'>elsif</span>  <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sameDiceRerollType'>sameDiceRerollType</span> <span class='op'>&lt;=</span> <span class='int'>1</span> <span class='comment'># ダメージのみ振り足し
</span>      <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ダメージのみ振り足し</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_double_check'>double_check</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span>
    <span class='kw'>else</span> <span class='comment'># 両方振り足し
</span>      <span class='id identifier rubyid_double_check'>double_check</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>double_check</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_double_check'>double_check</span><span class='rparen'>)</span>

  <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^([\d]+\*[\d]+)\*(.+)|(.+)\*([\d]+\*[\d]+)$|(.+)\*([\d]+\*[\d]+)\*(.+))</span><span class='regexp_end'>/</span></span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>if</span>  <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_parren_killer'>parren_killer</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>
    <span class='kw'>elsif</span>  <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_parren_killer'>parren_killer</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>elsif</span>  <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>7</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_string'>string</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>6</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_parren_killer'>parren_killer</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>7</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>8</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>string</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_string'>string</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_emptyResult'>emptyResult</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_dice_total'>dice_total</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_n'>dice_n</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_n1'>n1</span><span class='comma'>,</span> <span class='id identifier rubyid_n_max'>n_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_cnt_total'>dice_cnt_total</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_mul_cmd'>mul_cmd</span> <span class='op'>=</span> <span class='id identifier rubyid_string'>string</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mul_cmd'>mul_cmd</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_mul_line'>mul_line</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_m'>m</span> <span class='op'>=</span> <span class='id identifier rubyid_mul_line'>mul_line</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>([\d]+)D([\d]+)(@(\d+))?(/\d+[UR]?)?</span><span class='regexp_end'>}i</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_dice_count'>dice_count</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='id identifier rubyid_dice_max'>dice_max</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='id identifier rubyid_critical'>critical</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='id identifier rubyid_slashMark'>slashMark</span> <span class='op'>=</span> <span class='id identifier rubyid_m'>m</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span>

      <span class='kw'>return</span> <span class='id identifier rubyid_emptyResult'>emptyResult</span> <span class='kw'>if</span>  <span class='lparen'>(</span><span class='id identifier rubyid_critical'>critical</span> <span class='op'>!=</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_is2dCritical'>is2dCritical</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_emptyResult'>emptyResult</span> <span class='kw'>if</span>  <span class='id identifier rubyid_dice_max'>dice_max</span> <span class='op'>&gt;</span> <span class='gvar'>$DICE_MAXNUM</span>

      <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_now'>dice_now</span><span class='comma'>,</span> <span class='id identifier rubyid_output_tmp'>output_tmp</span><span class='comma'>,</span> <span class='id identifier rubyid_n1_count'>n1_count</span><span class='comma'>,</span> <span class='id identifier rubyid_max_number_tmp'>max_number_tmp</span><span class='comma'>,</span> <span class='id identifier rubyid_result_dice_count'>result_dice_count</span> <span class='op'>=</span>
        <span class='id identifier rubyid_rollDiceAddingUpCommand'>rollDiceAddingUpCommand</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_count'>dice_count</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_slashMark'>slashMark</span><span class='comma'>,</span> <span class='id identifier rubyid_double_check'>double_check</span><span class='comma'>,</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span><span class='comma'>,</span> <span class='id identifier rubyid_critical'>critical</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_output'>output</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='id identifier rubyid_output_tmp'>output_tmp</span>

      <span class='id identifier rubyid_dice_total'>dice_total</span> <span class='op'>*=</span> <span class='id identifier rubyid_dice_now'>dice_now</span>

      <span class='id identifier rubyid_dice_n'>dice_n</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_now'>dice_now</span>
      <span class='id identifier rubyid_dice_cnt_total'>dice_cnt_total</span> <span class='op'>+=</span> <span class='id identifier rubyid_result_dice_count'>result_dice_count</span>
      <span class='id identifier rubyid_n1'>n1</span> <span class='op'>+=</span> <span class='id identifier rubyid_n1_count'>n1_count</span>
      <span class='id identifier rubyid_n_max'>n_max</span> <span class='op'>+=</span> <span class='id identifier rubyid_max_number_tmp'>max_number_tmp</span>

    <span class='kw'>else</span>
      <span class='id identifier rubyid_mul_line'>mul_line</span> <span class='op'>=</span> <span class='id identifier rubyid_mul_line'>mul_line</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dice_total</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_total'>dice_total</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mul_line</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_mul_line'>mul_line</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_dice_total'>dice_total</span> <span class='op'>*=</span> <span class='id identifier rubyid_mul_line'>mul_line</span>

      <span class='kw'>unless</span> <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_mul_line'>mul_line</span> <span class='op'>&lt;</span> <span class='int'>0</span>
        <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mul_line'>mul_line</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='id identifier rubyid_mul_line'>mul_line</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rollDiceAddingUp() end output</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_total'>dice_total</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_n'>dice_n</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_n1'>n1</span><span class='comma'>,</span> <span class='id identifier rubyid_n_max'>n_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_cnt_total'>dice_cnt_total</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_dice_total'>dice_total</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_n'>dice_n</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_n1'>n1</span><span class='comma'>,</span> <span class='id identifier rubyid_n_max'>n_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_cnt_total'>dice_cnt_total</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rollDiceAddingUpCommand-instance_method">
  
    #<strong>rollDiceAddingUpCommand</strong>(dice_count, dice_max, slashMark, double_check, isCheckSuccess, critical)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 196</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rollDiceAddingUpCommand'>rollDiceAddingUpCommand</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_count'>dice_count</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_slashMark'>slashMark</span><span class='comma'>,</span> <span class='id identifier rubyid_double_check'>double_check</span><span class='comma'>,</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span><span class='comma'>,</span> <span class='id identifier rubyid_critical'>critical</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result_dice_count'>result_dice_count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_dice_now'>dice_now</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_n1_count'>n1_count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_max_number'>max_number</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_dice_str'>dice_str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_dice_arry'>dice_arry</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_dice_arry'>dice_arry</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_count'>dice_count</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_loop_count'>loop_count</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>before while dice_arry</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_arry'>dice_arry</span><span class='rparen'>)</span>

  <span class='kw'>while</span> <span class='op'>!</span><span class='id identifier rubyid_dice_arry'>dice_arry</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IN while dice_arry</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_arry'>dice_arry</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_dice_wk'>dice_wk</span> <span class='op'>=</span> <span class='id identifier rubyid_dice_arry'>dice_arry</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
    <span class='id identifier rubyid_result_dice_count'>result_dice_count</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_wk'>dice_wk</span>

    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dice_wk</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_wk'>dice_wk</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dice_max</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(sortType &amp; 1)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lparen'>(</span><span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sortType'>sortType</span> <span class='op'>&amp;</span> <span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_dice_dat'>dice_dat</span> <span class='op'>=</span> <span class='id identifier rubyid_rollLocal'>rollLocal</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_wk'>dice_wk</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sortType'>sortType</span> <span class='op'>&amp;</span> <span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dice_dat</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_dice_new'>dice_new</span> <span class='op'>=</span> <span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_dice_now'>dice_now</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_new'>dice_new</span>

    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>slashMark</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_slashMark'>slashMark</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_dice_now'>dice_now</span> <span class='op'>=</span> <span class='id identifier rubyid_getSlashedDice'>getSlashedDice</span><span class='lparen'>(</span><span class='id identifier rubyid_slashMark'>slashMark</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_now'>dice_now</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_dice_str'>dice_str</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>][</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_dice_str'>dice_str</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_debug'><span class='object_link'><a href="top-level-namespace.html#debug-instance_method" title="#debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dice_str</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_dice_str'>dice_str</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_dice_str'>dice_str</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_n1_count'>n1_count</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_max_number'>max_number</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>

    <span class='comment'># 振り足しありでダイスが二個以上
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_double_check'>double_check</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_dice_wk'>dice_wk</span> <span class='op'>&gt;=</span> <span class='int'>2</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_addDiceArrayByAddDiceCount'>addDiceArrayByAddDiceCount</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_dat'>dice_dat</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_arry'>dice_arry</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_wk'>dice_wk</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_check2dCritical'>check2dCritical</span><span class='lparen'>(</span><span class='id identifier rubyid_critical'>critical</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_new'>dice_new</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_arry'>dice_arry</span><span class='comma'>,</span> <span class='id identifier rubyid_loop_count'>loop_count</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_loop_count'>loop_count</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>

  <span class='comment'># ダイス目文字列からダイス値を変更する場合の処理（現状クトゥルフ・テック専用）
</span>  <span class='id identifier rubyid_dice_now'>dice_now</span> <span class='op'>=</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_changeDiceValueByDiceText'>changeDiceValueByDiceText</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_now'>dice_now</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_str'>dice_str</span><span class='comma'>,</span> <span class='id identifier rubyid_isCheckSuccess'>isCheckSuccess</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sendMode'>sendMode</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dice_now'>dice_now</span><span class='embexpr_end'>}</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dice_str'>dice_str</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='ivar'>@diceBot</span><span class='period'>.</span><span class='id identifier rubyid_sendMode'>sendMode</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span> <span class='id identifier rubyid_dice_now'>dice_now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_now'>dice_now</span><span class='comma'>,</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='id identifier rubyid_n1_count'>n1_count</span><span class='comma'>,</span> <span class='id identifier rubyid_max_number'>max_number</span><span class='comma'>,</span> <span class='id identifier rubyid_result_dice_count'>result_dice_count</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rollLocal-instance_method">
  
    #<strong>rollLocal</strong>(dice_wk, dice_max, sortType)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


293
294
295
296
297
298
299</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'dice/AddDice.rb', line 293</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rollLocal'>rollLocal</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_wk'>dice_wk</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_sortType'>sortType</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_dice_max'>dice_max</span> <span class='op'>==</span> <span class='int'>66</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_rollD66'>rollD66</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_wk'>dice_wk</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='ivar'>@bcdice</span><span class='period'>.</span><span class='id identifier rubyid_roll'>roll</span><span class='lparen'>(</span><span class='id identifier rubyid_dice_wk'>dice_wk</span><span class='comma'>,</span> <span class='id identifier rubyid_dice_max'>dice_max</span><span class='comma'>,</span> <span class='id identifier rubyid_sortType'>sortType</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 31 21:10:51 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.6.1).
</div>

    </div>
  </body>
</html>